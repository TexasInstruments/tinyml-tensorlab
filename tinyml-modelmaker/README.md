# Tiny ML ModelMaker

Tiny ML Modelmaker is an end-to-end model development tool that contains dataset handling, model training and compilation. Currently, it doesn't have an integrated feature to annotate data, but can accept annotated Dataset from a tool such as [Label Studio](https://labelstud.io/)

This repository stitches individual core scripts and utilities present in Tiny ML Tinyverse to make a simple and consistent interface for model development. This does not support all the models that can be trained and compiled using our tools, but only a subset. This is a commandline tool and requires a Linux/Windows PC.

The following are the key functionality supported by this tool:
- Dataset handling: This dataset formats supported by this tool is described in a section below. This can convert dataset formats and can automatically split the given dataset into train and validation sets (if it is not already split).
- Model training: Model training repositories such as [tinyml-tinyverse](https://github.com/TexasInstruments/tinyml-tinyverse) built using [PyTorch](https://pytorch.org/) are integrated. Several models with pretrained checkpoints are incorporated for each of these repositories. 
- Model compilation: Model compilation tools [TIâ€™s Neural Network Compiler](https://software-dl.ti.com/mctools/nnc/mcu/users_guide/) for TI's microcontrollers have been integrated.


Tasks and Models

| Task | Modality                  | Example Application                                     | Description |
| --- |---------------------------|---------------------------------------------------------| --- | 
| Classification | Timeseries (Univariate)   | Arc Detection, Fall Detection                           | 1 to n-class classification of timeseries data |
| Classification | Timeseries (Multivariate) | Arc Detection, Motor Bearing Fault Detection, Gyroscope | 1 to n-class classification of timeseries data |



These functionalities that are supported are fully integrated and the user can control it by setting  parameters in the config file.

<hr>

## Note: Dataset format
<details>
<summary> For Timeseries Classification </summary>

- The dataset format is similar to that of the [Google Speech Commands](https://www.tensorflow.org/datasets/catalog/speech_commands) dataset, but there are some changes as explained below.
 

####  Dataset format
The dataset should have the following structure. 

<pre>
data/projects/<dataset_name>/dataset
                             |
                             |--classes
                             |     |-- the directories should be here
                             |     |-- class1
                             |     |-- class2
                             |
                             |--annotations
                                   |--instances_train_list.txt
                                   |--instances_val_list.txt
</pre>

- Use a suitable dataset name instead of dataset_name
- Look at the example dataset [Arc Fault Classification](https://software-dl.ti.com/jacinto7/esd/modelzoo/other/tinyml/00_05_00/datasets/arc_fault_classification_dsk.zip) to understand further.
- In the config file, provide the name of the dataset (dataset_name in this example) in the field dataset_name and provide the path or URL in the field input_data_path.
- Then the ModelMaker tool can be invoked with the config file.


#### Notes
If the dataset has already been split into train and validation set already, it is possible to provide those paths separately as a tuple in input_data_path.

After the model compilation, the compiled models will be available in a folder inside [./data/projects](./data/projects)

The config file can be in .yaml or in .json format
</details>


<hr>

## Additional Docs & Examples

| Documentation                                                                                                                | Description                                                                                                                               |
|------------------------------------------------------------------------------------------------------------------------------|-------------------------------------------------------------------------------------------------------------------------------------------|
| [A guide to Bring Your Own Data](examples/grid_stability/readme.md)                                                          | Understanding the outputs generated by Tiny ML Modelmaker                                                                                 |
| [Playing with your Own Dataset](examples/electrical_fault/readme.md)                                                         | A guide to explore Tiny ML Modelmaker from an external dataset POV                                                                        |
| [Understanding the config.yaml](./docs/UnderstandingConfigFile.md)                                                           | Basics of the config.yaml that can run Tiny ML Modelmaker                                                                                 |
| [Understanding Data Processing and Feature Extraction in the config.yaml](examples/motor_fault_classification_dsk/readme.md) | Explore the config.yaml with a more descriptive explanation on the Data Processing and Feature Extraction sections                        |
| [How Good is your Feature Extraction?](examples/how_good_is_your_feature_extraction/readme.md)                               | Understanding the need for feature extraction and insights into the dataset that Tiny ML Modelmaker provides                              |
| [Post Training Analysis](examples/post_training_analysis/readme.md)                                                          | Understanding the Post Training Insights that the Tiny ML Modelmaker generates                                                            |
| [Bring Your Own Model for Compilation](./docs/BYOM_for_Compilation.md)                                                       | You have your own (onnx/tflite) model that you think is capable of running on TI device. You want to use Tiny ML modelmaker to compile it |
| [Adding Models](./docs/AddingModels.md)                                                                                      | A guide to adding your own model definitions to Tiny Ml Tinyverse, Modelmaker                                                             |
| [Adding Modalities](./docs/AddingModalities.md)                                                                              | A guide to creating your own new flow (for example: audio_classification)                                                                 |
|                                                                                                                              |                                                                                                                                           |



